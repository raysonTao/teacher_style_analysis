**数据分段策略：从基线到改进**

**（1）基线方法：固定时间窗口分段**

在初步实验中，我们采用固定时间窗口分段作为基线方法。将课堂视频按固定时间窗口 $T = 10s$ 分段，设完整课堂时长为 $L$，则生成 $N = \lfloor L/T \rfloor$ 个片段：

$$\mathcal{S}_{\text{baseline}} = \{S_1, S_2, ..., S_N\}$$

每个片段 $S_i$ 包含：
- **视频帧序列**：$V_i = \{v_1, v_2, ..., v_{250}\}$（25fps × 10s = 250帧）
- **音频片段**：$A_i \in \mathbb{R}^{160000}$（16kHz × 10s = 160,000采样点）
- **转写文本**：$T_i$（经Whisper ASR生成）

**基线方法的优势**：
- 实现简单，易于工程化部署
- 计算开销固定，便于批量处理（45分钟课堂生成270个片段）
- 时序对齐容易（音视频按10秒固定对齐）

**基线方法的局限**：

通过对209个样本的定性分析，我们发现固定分段在约**23.4%**的样本中出现了语义割裂现象。典型案例包括：
- **逻辑推导被割裂**（占比35%）：完整的"因为...所以...因此"逻辑链被分割到不同片段
- **概念定义不完整**（占比28%）："所谓X，就是..."的定义句被截断
- **案例讲解跨段**（占比37%）：多句案例描述被人为分割

定量分析显示，固定分段导致教学意图识别F1值下降约**5.2%**，风格识别准确率下降约**2.1%**（详见4.6节消融实验）。

**（2）改进方法：语义驱动的话语分段**

基于上述实验发现，我们提出**语义驱动的话语分段策略**，以保证每个分析单元是一个**语义完整的教学话语单元（Semantic Unit）**。具体流程如下：

① **ASR全文转写**：使用Whisper Large-v3模型对完整课堂音频进行转写，获得带时间戳的文本序列 $\mathcal{T} = \{(w_1, t_1), (w_2, t_2), ..., (w_M, t_M)\}$，其中 $w_i$ 是词语，$t_i$ 是时间戳；

② **句子边界检测**：结合标点符号（句号、问号、感叹号）与停顿时长（$\Delta t > 300$ms）识别句子边界，将文本序列切分为句子序列 $\mathcal{S} = \{s_1, s_2, ..., s_K\}$；

③ **依存句法分析**：使用预训练的中文句法分析模型（HanLP）识别句子间的逻辑连接关系，提取逻辑连接词（"因为""所以""但是"等）及其作用域；

④ **话语边界检测**：基于以下规则判断话语单元结束：
  - 逻辑链完整（如"因为...所以..."结构完成）
  - 出现话题转换标记（"那么""接下来""现在"）
  - 单元时长超过上限（$\Delta t > 30$s）

⑤ **形成语义单元**：将一个或多个连续句子合并为一个语义单元 $U_i$，设完整课堂时长为 $L$，则生成 $N$ 个语义单元（通常 $N \approx 150 \sim 200$ 个/45分钟课）：

$$\mathcal{U} = \{U_1, U_2, ..., U_N\}$$

每个语义单元 $U_i$ 包含：
- **文本内容**：$T_i = \{s_j, s_{j+1}, ..., s_k\}$（一个或多个句子）
- **音频片段**：$A_i \in \mathbb{R}^{N_s}$（$N_s$ 为采样点数，通常 $5s \leq \Delta t_i \leq 30s$）
- **视频帧序列**：$V_i = \{v_1, v_2, ..., v_{T_i}\}$（帧数 $T_i = \text{fps} \times \Delta t_i$，通常125-750帧）
- **时间范围**：$(t_{\text{start}}^i, t_{\text{end}}^i)$

**改进方法的优势**：

相比固定时间窗口，语义驱动分段具有以下优势：
- **语义完整性提升**：从76.6%提升至**95.3%**（提升18.7个百分点）
- **适应教学节奏**：单元时长灵活（5-30秒），自动适应不同教学风格
- **后续任务性能提升**：教学意图识别F1值提升**5.2%**，风格识别准确率提升**2.1%**
- **单元数量更合理**：平均175个单元/课（vs 固定270个），减少35%，降低冗余

例如，一个完整的逻辑推导单元（"因为速度等于位移除以时间，所以我们可以得到v=s/t，因此当时间固定时，速度与位移成正比"）会被完整保留，而不会被人为切断。这使得后续的教学意图识别模型能够捕捉完整的逻辑链，识别准确率显著提升（见4.6节消融实验）。
