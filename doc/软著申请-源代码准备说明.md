# 软著申请源代码准备说明

**软件名称**：教师教学风格画像分析系统V1.0
**准备日期**：2026年01月27日

---

## 一、源代码要求概述

根据《计算机软件著作权登记办法》，源程序鉴别材料需提交：

- **页数**：连续60页（前30页 + 后30页）
- **行数**：每页不少于50行（结束页除外）
- **格式**：A4纸打印，每行不超过80个字符
- **页码**：右上角标注页码
- **文件头**：每页顶部标注软件名称和版本号

---

## 二、已准备的源代码文件

### 前30页源代码（约1500行）

| 文件 | 起始行 | 结束行 | 说明 |
|------|--------|--------|------|
| app.py | 1 | 200 | Flask应用主入口，系统初始化 |
| src/models/deep_learning/mman_model.py | 1 | 291 | MMAN跨模态注意力网络模型定义 |
| src/models/deep_learning/components.py | 1 | 350 | 模型组件（Transformer、BiLSTM、Attention） |
| src/features/video_feature_extractor.py | 1 | 300 | 视频特征提取（YOLOv8+DeepSORT+ST-GCN） |
| src/features/audio_feature_extractor.py | 1 | 359 | 音频特征提取（Wav2Vec2） |

### 后30页源代码（约1500行）

| 文件 | 起始行 | 结束行 | 说明 |
|------|--------|--------|------|
| src/features/text_feature_extractor.py | 1 | 250 | 文本特征提取（BERT对话行为识别） |
| src/models/deep_learning/trainer.py | 1 | 445 | 模型训练器，包含训练循环和验证逻辑 |
| src/experiments/visualizations/shap_visualizer.py | 1 | 278 | SHAP可解释性分析与可视化 |
| src/api/routes.py | 1 | 400 | RESTful API路由定义 |
| tasks.py | 1 | 177 | Celery异步任务定义 |

---

## 三、源代码生成方法

### 方法1：使用Python脚本生成（推荐）

创建脚本`generate_source_code_pdf.py`：

```python
#!/usr/bin/env python3
"""生成软著申请源代码PDF"""

import os
from pathlib import Path

# 定义要包含的源文件（前30页）
front_files = [
    'app.py',
    'src/models/deep_learning/mman_model.py',
    'src/models/deep_learning/components.py',
    'src/features/video_feature_extractor.py',
    'src/features/audio_feature_extractor.py',
]

# 定义要包含的源文件（后30页）
back_files = [
    'src/features/text_feature_extractor.py',
    'src/models/deep_learning/trainer.py',
    'src/experiments/visualizations/shap_visualizer.py',
    'src/api/routes.py',
    'tasks.py',
]

def generate_source_code(files, output_path, start_page=1):
    """生成源代码文本文件"""
    line_number = 1
    page_number = start_page
    lines_per_page = 50
    current_page_lines = 0

    with open(output_path, 'w', encoding='utf-8') as out_file:
        # 写入页眉
        out_file.write(f"教师教学风格画像分析系统V1.0 - 第{page_number}页\n\n")

        for file_path in files:
            if not os.path.exists(file_path):
                print(f"Warning: {file_path} not found, skipping...")
                continue

            # 写入文件分隔符
            out_file.write(f"\n{'='*80}\n")
            out_file.write(f"文件: {file_path}\n")
            out_file.write(f"{'='*80}\n\n")
            current_page_lines += 4

            # 读取文件内容
            with open(file_path, 'r', encoding='utf-8') as source_file:
                for line in source_file:
                    # 检查是否需要换页
                    if current_page_lines >= lines_per_page:
                        page_number += 1
                        current_page_lines = 0
                        out_file.write(f"\n\n{'-'*80}\n")
                        out_file.write(f"教师教学风格画像分析系统V1.0 - 第{page_number}页\n\n")

                    # 写入带行号的代码行
                    out_file.write(f"{line_number:5d}  {line}")
                    line_number += 1
                    current_page_lines += 1

    print(f"Generated: {output_path} ({page_number} pages)")

# 生成前30页
generate_source_code(front_files, '软著申请-04A-源代码前30页.txt', start_page=1)

# 生成后30页
generate_source_code(back_files, '软著申请-04B-源代码后30页.txt', start_page=31)

print("\n源代码文本文件生成完成！")
print("请使用以下命令转换为PDF：")
print("  1. 使用Microsoft Word打开txt文件")
print("  2. 设置字体为Courier New（等宽字体）")
print("  3. 设置字号为10pt")
print("  4. 设置页边距为2cm")
print("  5. 另存为PDF格式")
```

运行脚本：

```bash
python generate_source_code_pdf.py
```

### 方法2：使用enscript（Linux/Mac）

```bash
# 安装enscript
sudo apt install enscript  # Ubuntu/Debian
brew install enscript      # macOS

# 生成前30页PDF
enscript -B -f Courier10 \
  --header='教师教学风格画像分析系统V1.0|第$%页|' \
  --line-numbers=1 \
  -p - \
  app.py \
  src/models/deep_learning/mman_model.py \
  src/models/deep_learning/components.py \
  src/features/video_feature_extractor.py \
  src/features/audio_feature_extractor.py \
  | ps2pdf - 软著申请-04A-源代码前30页.pdf

# 生成后30页PDF
enscript -B -f Courier10 \
  --header='教师教学风格画像分析系统V1.0|第$%页|' \
  --line-numbers=1 \
  -p - \
  src/features/text_feature_extractor.py \
  src/models/deep_learning/trainer.py \
  src/experiments/visualizations/shap_visualizer.py \
  src/api/routes.py \
  tasks.py \
  | ps2pdf - 软著申请-04B-源代码后30页.pdf

# 合并PDF
pdftk 软著申请-04A-源代码前30页.pdf \
      软著申请-04B-源代码后30页.pdf \
      cat output 软著申请-04-源代码.pdf
```

### 方法3：手动整理（最稳妥）

**步骤**：

1. **复制源代码**：
   ```bash
   # 创建临时目录
   mkdir -p /tmp/software_copyright

   # 复制前30页的源文件
   cp app.py /tmp/software_copyright/
   cp src/models/deep_learning/mman_model.py /tmp/software_copyright/
   # ...其他文件
   ```

2. **添加行号**：
   使用文本编辑器（如VS Code、Sublime Text）打开文件，启用行号显示。

3. **格式化输出**：
   - 字体：Courier New（等宽字体）
   - 字号：10pt
   - 页边距：上下左右各2cm
   - 行间距：单倍行距

4. **添加页眉**：
   每页顶部添加：`教师教学风格画像分析系统V1.0 - 第X页`

5. **导出PDF**：
   使用Word或专业排版工具导出为PDF。

---

## 四、源代码质量检查

提交前请检查：

### 4.1 格式检查

- [ ] 总页数为60页（前30页 + 后30页）
- [ ] 每页不少于50行（结束页除外）
- [ ] 每页顶部有软件名称和版本号
- [ ] 右上角有页码（第1页至第60页）
- [ ] 代码行号连续
- [ ] 使用等宽字体（如Courier New）

### 4.2 内容检查

- [ ] 代码完整，能够体现软件核心功能
- [ ] 前30页从系统入口开始，包含主要模块
- [ ] 后30页包含核心业务逻辑和算法实现
- [ ] 代码逻辑清晰，有必要的注释
- [ ] 无明显错误或不完整的代码段

### 4.3 安全检查

- [ ] 代码中无数据库密码
- [ ] 代码中无API密钥或access token
- [ ] 代码中无邮箱密码或SMTP配置
- [ ] 代码中无其他敏感信息

如有敏感信息，请替换为占位符：

```python
# 原代码
DATABASE_PASSWORD = "MySecretPassword123"

# 修改为
DATABASE_PASSWORD = "********"  # 已脱敏
```

---

## 五、示例页面格式

```
教师教学风格画像分析系统V1.0                                    第1页

================================================================================
文件: app.py
================================================================================

    1  """教师教学风格画像分析系统 - Flask应用主入口
    2
    3  本模块负责初始化Flask应用，配置路由、数据库、Celery任务队列等。
    4  """
    5
    6  import os
    7  from flask import Flask, request, jsonify
    8  from flask_sqlalchemy import SQLAlchemy
    9  from flask_cors import CORS
   10  from celery import Celery
   11
   12  # 初始化Flask应用
   13  app = Flask(__name__)
   14  app.config['SECRET_KEY'] = os.getenv('SECRET_KEY', 'dev-secret-key')
   15  app.config['SQLALCHEMY_DATABASE_URI'] = os.getenv(
   16      'DATABASE_URL',
   17      'postgresql://user:password@localhost/teacher_style_db'
   18  )
   19  app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False
   20
   21  # 初始化扩展
   22  db = SQLAlchemy(app)
   23  CORS(app, resources={r"/api/*": {"origins": "*"}})
   24
   25  # 初始化Celery
   26  celery = Celery(
   27      app.import_name,
   28      broker=os.getenv('CELERY_BROKER_URL', 'redis://localhost:6379/0'),
   29      backend=os.getenv('CELERY_RESULT_BACKEND', 'redis://localhost:6379/0')
   30  )
   31  celery.conf.update(app.config)
   32
   33  # 导入路由
   34  from api import routes
   35
   36  @app.route('/health', methods=['GET'])
   37  def health_check():
   38      """健康检查端点"""
   39      return jsonify({
   40          'status': 'healthy',
   41          'version': '1.0',
   42          'service': '教师教学风格画像分析系统'
   43      }), 200
   44
   45  if __name__ == '__main__':
   46      app.run(
   47          host='0.0.0.0',
   48          port=5000,
   49          debug=os.getenv('FLASK_DEBUG', 'False') == 'True'
   50      )

--------------------------------------------------------------------------------
```

---

## 六、常见问题

**Q1: 可以提交压缩后的代码吗？**

A: 不可以。必须提交可阅读的源代码，不能是编译后的二进制文件或混淆后的代码。

**Q2: 可以提交第三方库的代码吗？**

A: 不可以。只能提交自己编写的原创代码，不能包含开源库或第三方代码。如果使用了第三方库，只提交调用接口的代码即可。

**Q3: 前30页和后30页之间可以有间隔吗？**

A: 可以。前30页可以从任意位置开始，后30页可以从另一个位置开始，但同一部分内必须连续。

**Q4: 每页正好50行还是可以多一些？**

A: 可以多，但不能少（除了结束页）。通常每页50-70行比较合适。

**Q5: 代码中的注释算行数吗？**

A: 算。注释也是源代码的一部分，计入总行数。

---

## 七、提交清单

准备完成后，请确认以下文件：

- [ ] 软著申请-04A-源代码前30页.pdf
- [ ] 软著申请-04B-源代码后30页.pdf
- [ ] 软著申请-04-源代码.pdf（前后合并版）

或者直接提交合并后的单个PDF：

- [ ] 软著申请-04-源代码.pdf（60页完整版）

---

**准备人**：[申请人姓名]
**日期**：2026年01月27日

**备注**：本文档仅供内部参考，实际提交时只需提交源代码PDF，无需提交此说明文档。
