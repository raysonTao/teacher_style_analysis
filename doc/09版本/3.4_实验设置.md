## 3.4 实验设置

### 3.4.1 数据集划分

本研究使用mm-tba和来自网络的自建教师风格数据集，样本分布见**表4.1**。

**数据集划分**：

\- 训练集：$D_{\text{train}} = 125$样本（60%）

\- 验证集：$D_{\text{val}} = 31$样本（15%）

\- 测试集：$D_{\text{test}} = 53$样本（25%）

**类别平衡性**：使用加权交叉熵损失处理类别不平衡：

$$\mathcal{L}_{\text{weighted}} = - \sum_{i = 1}^{N}{\sum_{k = 1}^{7}w_{k}} \cdot y_{i,k}\log\left( {\widehat{y}}_{i,k} \right)$$

其中，类别权重 $w_{k}$ 与样本数成反比：

$$w_{k} = \frac{N}{7 \cdot n_{k}}$$

$n_{k}$ 是类别 $k$ 的样本数，$N$ 是总样本数。

### 3.4.2 实验环境配置

完整配置见**表4.2和表4.3**。关键配置：
- GPU：NVIDIA RTX 3090（24GB）
- 深度学习框架：PyTorch 2.0.1 + CUDA 11.8
- 训练超参数：Adam优化器，初始学习率 $\eta_{0} = 10^{- 4}$，Batch Size = 32

### 3.4.3 评估指标体系

#### （1）分类性能指标

**准确率（Accuracy）**：

$$\text{Accuracy} = \frac{1}{N}\sum_{i = 1}^{N}\mathbb{1}\left( {\widehat{y}}_{i} = y_{i} \right)$$

其中，$\mathbb{1}( \cdot )$ 是指示函数，${\widehat{y}}_{i}$ 是预测标签，$y_{i}$ 是真实标签。

**精确率（Precision）与召回率（Recall）**：

对于类别 $k$：

$$\text{Precision}_{k} = \frac{\text{TP}_{k}}{\text{TP}_{k} + \text{FP}_{k}}$$

$$\text{Recall}_{k} = \frac{\text{TP}_{k}}{\text{TP}_{k} + \text{FN}_{k}}$$

其中，$\text{TP}_{k}$ 是真正例，$\text{FP}_{k}$ 是假正例，$\text{FN}_{k}$ 是假负例。

**F1分数（F1-Score）**：

$$F1_{k} = 2 \times \frac{\text{Precision}_{k} \times \text{Recall}_{k}}{\text{Precision}_{k} + \text{Recall}_{k}}$$

**宏平均F1（Macro-F1）**：

$$\text{Macro-F1} = \frac{1}{K}\sum_{k = 1}^{K}F1_{k}$$

其中，$K = 7$ 是类别数。

**Cohen's Kappa系数**：

$$\kappa = \frac{p_{o} - p_{e}}{1 - p_{e}}$$

其中：
- $p_{o}$ 是观测一致性（Accuracy）
- $p_{e} = \sum_{k = 1}^{K}\frac{n_{k,\text{true}} \cdot n_{k,\text{pred}}}{N^{2}}$ 是期望一致性

Kappa值解释：$\kappa < 0.4$（一致性差），$0.4 \leq \kappa < 0.75$（中等），$\kappa \geq 0.75$（实质性一致）。

#### （2）统计显著性检验

**配对t检验（Paired t-test）**：

用于比较两个模型在相同测试集上的性能差异。设模型A和模型B在 $n$ 个样本上的准确率差异为 $d_{i} = A_{i} - B_{i}$，则：

$$t = \frac{\bar{d}}{s_{d}/\sqrt{n}}$$

其中：
- $\bar{d} = \frac{1}{n}\sum_{i = 1}^{n}d_{i}$ 是均值差异
- $s_{d} = \sqrt{\frac{1}{n - 1}\sum_{i = 1}^{n}\left( d_{i} - \bar{d} \right)^{2}}$ 是标准差

在显著性水平 $\alpha = 0.05$ 下，当 $|t| > t_{\alpha/2,n - 1}$ 时，拒绝原假设（两模型无差异）。

**McNemar检验**：

用于消融实验，检验模块移除对性能的影响。构建2×2列联表：

| | 完整模型正确 | 完整模型错误 |
|---|---|---|
| **简化模型正确** | $n_{11}$ | $n_{12}$ |
| **简化模型错误** | $n_{21}$ | $n_{22}$ |

卡方统计量：

$$\chi^{2} = \frac{\left( n_{12} - n_{21} \right)^{2}}{n_{12} + n_{21}}$$

当 $\chi^{2} > \chi_{0.05,1}^{2} = 3.84$ 时，认为模块移除的影响显著。

